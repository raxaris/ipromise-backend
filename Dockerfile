# üîπ 1. –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ Go –¥–ª—è —Å–±–æ—Ä–∫–∏ (—Å Alpine –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞)
FROM golang:1.23.4-alpine AS builder

# üîπ 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
WORKDIR /app

# üîπ 3. –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
COPY go.mod go.sum ./
RUN go mod download

# üîπ 4. –ö–æ–ø–∏—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
COPY . .

# üîπ 5. –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –±–∏–Ω–∞—Ä–Ω–∏–∫
RUN go build -o /main ./cmd/server/main.go

# üîπ 6. –§–∏–Ω–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑
FROM alpine:3

# üîπ 7. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è HTTPS)
RUN apk --no-cache add ca-certificates

# üîπ 8. –ö–æ–ø–∏—Ä—É–µ–º –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –∏–∑ builder-–æ–±—Ä–∞–∑–∞
COPY --from=builder /main /bin/main

# üîπ 9. –î–µ–ª–∞–µ–º –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
RUN chmod +x /bin/main

# üîπ 10. –£–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞
ENTRYPOINT ["/bin/main"]
